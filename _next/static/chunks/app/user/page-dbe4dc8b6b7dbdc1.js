(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{6424:function(e,t,r){Promise.resolve().then(r.bind(r,4396))},4396:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var n=r(1595),o=r(5837),i=r(9886),a=r(3261),c=r(9832),l=r(1741),s=r(4456),u=r(6387),d=r(4013),h=r(3146),f=r(4654),g=r(9376),m=r(8582),Z=r(156),p=r(2265),y=r(3996),v=r(3448),C=r(6419),b=r(9507),P=r(7468),w=r(2258),I=r(1327),x=r(20),k=r(7180),S=r(6620);function A(e){let{open:t,onClose:r,onAdd:o}=e,[i]=(0,y.fl)(),[a,c]=(0,Z.tN)(),l=a.apiClient;(0,v.PQ)(v.YI.primary.getArgb(i.scheme)),(0,v.PQ)(v.YI.onSurface.getArgb(i.scheme)),(0,v.PQ)(v.YI.onSurfaceVariant.getArgb(i.scheme));let s=(0,p.useRef)(null),u=async()=>{var e;let t=null===(e=s.current)||void 0===e?void 0:e.value;if(!t){(0,f.yv)("アカウント名を入力してください。",{variant:"error"});return}let n=l.apiGatewayUrl(),i=l.idToken();try{let e=await fetch("".concat(n,"/user/following"),{method:"POST",headers:{Authorization:"".concat(i),"Content-Type":"application/json"},body:JSON.stringify([t])});if(!e.ok){let t=await e.text();throw Error(t)}let a=await e.json();console.log(a),o(t),r()}catch(e){console.error(e),(0,f.yv)("".concat(e),{variant:"error"});return}};return(0,n.BX)(C.Z,{open:t,onClose:r,sx:{"& .MuiDialog-paper":{borderRadius:3}},children:[(0,n.tZ)(b.Z,{children:"推しを追加"}),(0,n.BX)(P.Z,{children:[(0,n.tZ)(w.Z,{}),(0,n.BX)(I.Z,{variant:"standard",children:[(0,n.tZ)(x.Z,{children:"推しインスタアカウント名"}),(0,n.tZ)(k.Z,{inputRef:s})]})]}),(0,n.BX)(S.Z,{children:[(0,n.tZ)(d.Z,{onClick:r,children:"キャンセル"}),(0,n.tZ)(d.Z,{variant:"contained",onClick:u,children:"追加"})]})]})}function T(){let[e]=(0,y.fl)();(0,v.PQ)(v.YI.primary.getArgb(e.scheme)),(0,v.PQ)(v.YI.onSurface.getArgb(e.scheme));let t=(0,v.PQ)(v.YI.onSurfaceVariant.getArgb(e.scheme)),r=(0,g.useRouter)(),[C,b]=(0,Z.tN)(),P=C.apiClient,[w,I]=(0,p.useState)([]),[x,k]=(0,p.useState)(!1),S=async()=>{let e=P.apiGatewayUrl(),t=P.idToken();console.log(e);try{let r=await fetch("".concat(e,"/user/following"),{method:"GET",headers:{Authorization:"".concat(t)}});if(!r.ok){let e=await r.text();throw Error(e)}let n=await r.json();I(n)}catch(e){console.error(e),(0,f.yv)("".concat(e),{variant:"error"})}},T=(0,p.useMemo)(()=>w.map(e=>(0,n.tZ)(a.ZP,{disablePadding:!0,secondaryAction:(0,n.tZ)("div",{children:(0,n.tZ)(c.Z,{sx:{color:t},edge:"end",onClick:e=>{},children:(0,n.tZ)(o.Z,{})})}),children:(0,n.tZ)(l.Z,{children:(0,n.tZ)(s.Z,{primary:e})})},e)),[w]);return(0,p.useEffect)(()=>{let e=C.status;if(console.log(e),"unauthenticated"===e){r.push("/login");return}"loading"!==e&&"authenticated"===e&&S()},[C.status]),(0,n.BX)("div",{children:[(0,n.tZ)(m.Z,{}),(0,n.BX)("div",{css:(0,h.iv)("display:flex;flex-direction:column;margin-top:80px;margin-left:16px;}"),children:[(0,n.BX)("div",{css:(0,h.iv)({display:"flex",flexDirection:"row",alignItems:"center"}),children:[(0,n.tZ)(u.Z,{variant:"h6",css:(0,h.iv)({fontWeight:"bold"}),children:"推し一覧"}),(0,n.tZ)(c.Z,{onClick:()=>{k(!0)},children:(0,n.tZ)(i.Z,{})})]}),0===w.length?(0,n.BX)("div",{css:(0,h.iv)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),children:[(0,n.tZ)(u.Z,{children:"推しはいません"}),(0,n.tZ)(d.Z,{onClick:()=>{k(!0)},children:"追加する"})]}):T]}),(0,n.tZ)(A,{open:x,onClose:()=>{k(!1)},onAdd:e=>{I([...w,e])}})]})}},8582:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(1595),o=r(4856),i=r(1495),a=r(1004),c=r(6387),l=r(3146),s=r(3996),u=r(3448);function d(){let[e]=(0,s.fl)(),t=(0,u.PQ)(u.YI.primary.getArgb(e.scheme));return(0,u.PQ)(u.YI.onSurface.getArgb(e.scheme)),(0,u.PQ)(u.YI.onSurfaceVariant.getArgb(e.scheme)),(0,n.tZ)(i.Z,{position:"fixed",elevation:0,css:(0,l.iv)({backgroundColor:"transparent",color:t}),children:(0,n.BX)(a.Z,{children:[(0,n.tZ)(o.Z,{sx:{mr:1}}),(0,n.tZ)(c.Z,{variant:"h6",css:(0,l.iv)({fontWeight:"bold"}),children:"推しコール"})]})})}},156:function(e,t,r){"use strict";r.d(t,{ZP:function(){return i},st:function(){return f},tN:function(){return u},xh:function(){return a}});var n=r(1595),o=r(2265);let i="ap-northeast-1_QZrerTmNH",a="7ibhthrioi38cqgoh1a9lco365",c="https://w1w476hjrd.execute-api.ap-northeast-1.amazonaws.com/dev",l=(0,o.createContext)({apiClient:h(c,void 0),status:"loading"}),s=(0,o.createContext)(()=>{}),u=()=>{let e=(0,o.useContext)(l),t=(0,o.useContext)(s);return[e,(0,o.useMemo)(()=>({setStatus:e=>{t({type:"setStatus",payload:{status:e}})}}),[])]},d=(e,t)=>"setStatus"===t.type?{...e,status:t.payload.status}:e;function h(e,t){return{apiGatewayUrl:()=>e,idToken:()=>t,setNewIdToken:e=>{localStorage.setItem("idToken",e),t=e,console.log("setNewIdToken",e)},restoreIdToken:async()=>{let r=localStorage.getItem("idToken");if(r)try{if(!(await fetch("".concat(e,"/user"),{method:"GET",headers:{Authorization:"".concat(r)}})).ok)throw Error("Unauthorized");return t=r,r}catch(e){console.error(e);return}}}}function f(e){let{children:t}=e,[r,i]=(0,o.useReducer)(d,{apiClient:h(c,void 0),status:"loading"}),a=(0,o.useRef)(!1);return(0,o.useEffect)(()=>{a.current||(a.current=!0,r.apiClient.restoreIdToken().then(e=>{i({type:"setStatus",payload:{status:e?"authenticated":"unauthenticated"}})}))},[]),(0,n.tZ)(l.Provider,{value:r,children:(0,n.tZ)(s.Provider,{value:i,children:t})})}},3996:function(e,t,r){"use strict";r.d(t,{ThemeStoreProvider:function(){return Z},fl:function(){return g}});var n=r(1595),o=r(5106),i=r.n(o),a=r(2017),c=r(9163),l=r(9026),s=r(3448),u=r(2265),d=r(4049);let h=(0,u.createContext)({scheme:new s.S2(s.OP.fromInt(15569803),!1,0),sourceColor:15569803}),f=(0,u.createContext)(()=>{}),g=()=>{let e=(0,u.useContext)(h),t=(0,u.useContext)(f);return[e,{resetSourceColor:()=>{t({type:"setTheme",payload:{scheme:new s.S2(s.OP.fromInt(15569803),!1,0),sourceColor:15569803}})}}]},m=(e,t)=>{if("setTheme"===t.type){let{scheme:r,sourceColor:n}=t.payload;return e.sourceColor===n?e:{...e,scheme:r,sourceColor:n}}return e},Z=e=>{let{children:t}=e,[r,o]=(0,u.useReducer)(m,{scheme:new s.S2(s.OP.fromInt(15569803),!1,0),sourceColor:15569803}),g=(0,a.Z)((0,c.Z)({palette:{mode:"light",primary:{main:(0,s.PQ)(s.YI.primary.getArgb(r.scheme))},secondary:{main:(0,s.PQ)(s.YI.secondary.getArgb(r.scheme))},background:{default:(0,s.PQ)(s.YI.surface.getArgb(r.scheme)),paper:(0,s.PQ)(s.YI.surfaceContainer.getArgb(r.scheme))},error:{main:(0,s.PQ)(s.YI.error.getArgb(r.scheme))},text:{primary:(0,s.PQ)(s.YI.onSurface.getArgb(r.scheme))}},typography:{fontFamily:i().style.fontFamily}}));return(0,n.BX)(l.Z,{theme:g,children:[(0,n.tZ)(d.Z,{styles:e=>({body:{transition:e.transitions.create(["background-color","transform"])}})}),(0,n.tZ)(h.Provider,{value:r,children:(0,n.tZ)(f.Provider,{value:o,children:t})})]})}}},function(e){e.O(0,[957,781,220,654,938,433,238,971,117,744],function(){return e(e.s=6424)}),_N_E=e.O()}]);